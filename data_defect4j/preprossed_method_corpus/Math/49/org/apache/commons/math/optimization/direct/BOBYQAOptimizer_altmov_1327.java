
















org apach common math optim direct



















powell' bobyqa algorithm implement translat
adapt fortran version
href http plato asu ftp softwar bobyqa zip
href http www optim onlin org html html
paper introduct

bobyqa suit high dimension problem
deriv case outperform
link powel optim powelloptim significantli stochast algorithm
link cmae optim cmaesoptim succe bobyqa
expens bobyqa consid replac
deriv base optim deriv approxim
finit differ

version


bobyqa optim bobyqaoptim















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































argument npt xpt xopt bmat zmat ndim
mean argument bobyqb
kopt index optim interpol point
knew index interpol point move
adelt current trust region bound
xnew set suitabl posit interpol point
xpt knew specif satisfi trust region
bound provid larg denomin call
updat step xnew xopt xopt restrict move
straight line xopt interpol point
xalt larg modulu knew lagrang
function subject constraint mention main
differ xnew xalt xopt constrain version
cauchi step trust region except xalt
calcul compon glag
alpha set knew diagon element matrix
cauchi set squar knew lagrang function
step xalt xopt xopt vector xalt return
cauchi set xalt calcul
glag work space vector length gradient
knew lagrang function xopt
hcol work space vector length npt deriv
coeffici knew lagrang function
work space vector length hold
constrain cauchi step xopt lagrang function
downhil version xalt uphil step calcul

set npt compon lead element
knew column matrix
param xpt
param xopt
param bmat
param zmat
param
param
param knew
param adelt
param xnew
param xalt

altmov
fortran matrix fortranmatrix xpt
fortran arrai fortranarrai xopt
fortran matrix fortranmatrix bmat
fortran matrix fortranmatrix zmat
fortran arrai fortranarrai
fortran arrai fortranarrai
knew
adelt
fortran arrai fortranarrai xnew
fortran arrai fortranarrai xalt

system println altmov xxx

current currentbest dimens getdimens
npt number interpol point numberofinterpolationpoint
ndim bmat row dimens getrowdimens

fortran arrai fortranarrai glag fortran arrai fortranarrai
fortran arrai fortranarrai hcol fortran arrai fortranarrai npt

fortran arrai fortranarrai work1 fortran arrai fortranarrai
fortran arrai fortranarrai work2 fortran arrai fortranarrai

alpha doubl nan
cauchi doubl nan

system gener local


local variabl
diff
ilbd isbd
slbd
iubd
vlag subd temp
ksav
step curv
iflag
scale csave tempa tempb tempd sumin
ggfree
ibdsav
dderiv bigstp predsq presav distsq stpsav wfixsq wsqsav


function bodi
math sqrt
npt
hcol set entri setentri

max npt max
temp zmat entri getentri knew
npt
hcol set entri setentri hcol entri getentri temp zmat entri getentri


alpha hcol entri getentri knew
half alpha

calcul gradient knew lagrang function xopt


glag set entri setentri bmat entri getentri knew

npt
temp

temp xpt entri getentri xopt entri getentri

temp hcol entri getentri temp

glag set entri setentri glag entri getentri temp xpt entri getentri



search larg denomin straight line xopt
interpol point slbd subd lower upper
bound step line turn predsq
set squar predict denomin line presav
set largest admiss predsq occur

presav
npt
trust region center interpol point index trustregioncenterinterpolationpointindex


dderiv
distsq

temp xpt entri getentri xopt entri getentri
dderiv glag entri getentri temp
distsq temp temp

subd adelt math sqrt distsq
slbd subd
ilbd
iubd
sumin math min subd

revis slbd subd bound


temp xpt entri getentri xopt entri getentri
temp
slbd temp entri getentri xopt entri getentri
slbd entri getentri xopt entri getentri temp
ilbd

subd temp entri getentri xopt entri getentri
comput max
sumin
entri getentri xopt entri getentri temp
subd math max
iubd

temp
slbd temp entri getentri xopt entri getentri
slbd entri getentri xopt entri getentri temp
ilbd

subd temp entri getentri xopt entri getentri
comput max
sumin
entri getentri xopt entri getentri temp
subd math max
iubd




seek larg modulu knew lagrang function index
interpol point line xopt knew

knew
diff dderiv
step slbd
vlag slbd dderiv slbd diff
isbd ilbd
temp subd dderiv subd diff
math ab temp math ab vlag
step subd
vlag temp
isbd iubd

tempd half dderiv
tempa tempd diff slbd
tempb tempd diff subd
tempa tempb
temp tempd tempd diff
math ab temp math ab vlag
step tempd diff
vlag temp
isbd



search line xopt point


step slbd
vlag slbd slbd
isbd ilbd
temp subd subd
math ab temp math ab vlag
step subd
vlag temp
isbd iubd

subd half
math ab vlag
step half
vlag
isbd


vlag dderiv


calcul predsq current line search maintain presav

temp step step distsq
predsq vlag vlag vlag vlag temp temp
predsq presav
presav predsq
ksav
stpsav step
ibdsav isbd



construct xnew satisfi bound constraint


temp xopt entri getentri stpsav xpt entri getentri ksav xopt entri getentri
comput max
comput min
entri getentri
entri getentri
math min temp
xnew set entri setentri math max

ibdsav
xnew set entri setentri ibdsav entri getentri ibdsav

ibdsav
xnew set entri setentri ibdsav entri getentri ibdsav


prepar iter method assembl constrain cauchi
step sum squar fix compon form
wfixsq free compon set bigstp

bigstp adelt adelt
iflag

l100
wfixsq
ggfree

work1 set entri setentri
comput min
xopt entri getentri entri getentri
glag entri getentri
tempa math min
comput max
xopt entri getentri entri getentri
glag entri getentri
tempb math max
tempa tempb
work1 set entri setentri bigstp
comput 2nd power
glag entri getentri
ggfree


ggfree
cauchi
alpha cauchi


investig compon fix
l120
temp adelt adelt wfixsq
temp
wsqsav wfixsq
step math sqrt temp ggfree
ggfree

work1 entri getentri bigstp
temp xopt entri getentri step glag entri getentri
temp entri getentri
work1 set entri setentri entri getentri xopt entri getentri
comput 2nd power
work1 entri getentri
wfixsq
temp entri getentri
work1 set entri setentri entri getentri xopt entri getentri
comput 2nd power
work1 entri getentri
wfixsq

comput 2nd power
glag entri getentri
ggfree



wfixsq wsqsav ggfree
l120

end l120

set remain free compon compon xalt
scale



work1 entri getentri bigstp
work1 set entri setentri step glag entri getentri
min math min entri getentri
xopt entri getentri work1 entri getentri
xalt set entri setentri math max entri getentri min
work1 entri getentri
xalt set entri setentri xopt entri getentri
glag entri getentri
xalt set entri setentri entri getentri

xalt set entri setentri entri getentri

glag entri getentri work1 entri getentri


set curv curvatur knew lagrang function
scale factor reduc modulu
lagrang function xopt set cauchi
squar function

curv
npt
temp

temp xpt entri getentri work1 entri getentri

curv hcol entri getentri temp temp

iflag
curv curv

curv curv
scale curv

temp xopt entri getentri scale work1 entri getentri
comput max
comput min
entri getentri
math min temp
xalt set entri setentri math max entri getentri

comput 2nd power
half scale
cauchi

comput 2nd power
half curv
cauchi


iflag xalt calcul revers
sign glag xalt vector
chosen larger cauchi

iflag

glag set entri setentri glag entri getentri
work2 set entri setentri xalt entri getentri

csave cauchi
iflag

l100
end l100
csave cauchi

xalt set entri setentri work2 entri getentri

cauchi csave


alpha cauchi
altmov





























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































